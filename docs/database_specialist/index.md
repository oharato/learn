## 2-1 正規化理論

- 正規化の目的
    - 更新時異常を排除すること
- 関数従属性とは、ある属性Xが決まれば、別の属性Yの値が一意に決まること
    - Xを決定項、Yを従属項と呼ぶ

### 2-1-2 第1正規形

```
関係（リレーション）スキーマRが第1正規形(the first nomal form, 1NF)であるとは、Rを定義するすべてのドメインがシンプルであるときをいう
```

- シンプルなドメインとは、属性が全て単一値をとること。すなわち、直積集合や冪集合がない状態。
- 直積集合とは、集合を組にしたもの。

|顧客名(顧客番号)|
|--|
|A商事(1)|
|B商事(2)|

↓　直積集合を排除

|顧客名|顧客番号|
|--|--|
|A商事|1|
|B商事|2|

- 冪集合とは、与えられた集合からその部分集合を元として含む集合のこと

|顧客名|商品番号|商品名|
|--|--|--|
|A商事|101|商品X|
| |102|商品Y|

(A商事は縦にセルが結合している)
1つの値に対して2つの値が対応している


↓　冪集合を排除

|顧客名|商品番号|商品名|
|--|--|--|
|A商事|101|商品X|
|A商事|102|商品Y|

```
候補キーとは、関係（リレーション）のタプルを一意に識別できる属性または属性の組のうち極小のもの
```

```
主キーとは、候補キーから1つを選んだもので次の条件を満たす。
１．主キーはタプルの一意識別能力を備えていること
２．主キーを構成する属性は空値(NULL)をとらないこと
```

主キー以外の候補キーを代理キーと呼ぶ。


#### 第1正規形の問題点

- タプル挿入時異常
    - 主キーにをNULLで登録しようとするとできない
- タプル更新時異常
    - 1行だけ更新するとデータに矛盾が生じる
- タプル削除時異常
    - 商品のデータを削除しようとすると注文のデータも一緒に消えてしまう


### 2-1-3 第2正規形

```
関係Rが第2正規形(the second form, 2NF)であるとは、つぎの2つの条件を満たすとき。
１．Rは第1正規形である
２．Rのすべての非キー属性はRの各候補キーに完全関数従属している
```

